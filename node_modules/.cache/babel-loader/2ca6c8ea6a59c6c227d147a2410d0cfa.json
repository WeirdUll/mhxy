{"remainingRequest":"/Users/liyulong/项目/mhxy/node_modules/babel-loader/lib/index.js!/Users/liyulong/项目/mhxy/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liyulong/项目/mhxy/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liyulong/项目/mhxy/src/views/permission/role.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liyulong/项目/mhxy/src/views/permission/role.vue","mtime":1638874516000},{"path":"/Users/liyulong/项目/mhxy/babel.config.js","mtime":1638874516000},{"path":"/Users/liyulong/项目/mhxy/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liyulong/项目/mhxy/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liyulong/项目/mhxy/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liyulong/项目/mhxy/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2xpeXVsb25nL1x1OTg3OVx1NzZFRS9taHh5L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvbGl5dWxvbmcvXHU5ODc5XHU3NkVFL21oeHkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5LmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy9saXl1bG9uZy9cdTk4NzlcdTc2RUUvbWh4eS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvbGl5dWxvbmcvXHU5ODc5XHU3NkVFL21oeHkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJ0AvdXRpbHMnOwppbXBvcnQgeyBnZXRSb3V0ZXMgYXMgX2dldFJvdXRlcywgZ2V0Um9sZXMgYXMgX2dldFJvbGVzLCBhZGRSb2xlLCBkZWxldGVSb2xlLCB1cGRhdGVSb2xlIH0gZnJvbSAnQC9hcGkvcm9sZSc7CnZhciBkZWZhdWx0Um9sZSA9IHsKICBrZXk6ICcnLAogIG5hbWU6ICcnLAogIGRlc2NyaXB0aW9uOiAnJywKICByb3V0ZXM6IFtdCn07CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcm9sZTogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFJvbGUpLAogICAgICByb3V0ZXM6IFtdLAogICAgICByb2xlc0xpc3Q6IFtdLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgZGlhbG9nVHlwZTogJ25ldycsCiAgICAgIGNoZWNrU3RyaWN0bHk6IGZhbHNlLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ3RpdGxlJwogICAgICB9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHJvdXRlc0RhdGE6IGZ1bmN0aW9uIHJvdXRlc0RhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLnJvdXRlczsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICAvLyBNb2NrOiBnZXQgYWxsIHJvdXRlcyBhbmQgcm9sZXMgbGlzdCBmcm9tIHNlcnZlcgogICAgdGhpcy5nZXRSb3V0ZXMoKTsKICAgIHRoaXMuZ2V0Um9sZXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFJvdXRlczogZnVuY3Rpb24gZ2V0Um91dGVzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRSb3V0ZXMoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzLnNlcnZpY2VSb3V0ZXMgPSByZXMuZGF0YTsKICAgICAgICAgICAgICAgIF90aGlzLnJvdXRlcyA9IF90aGlzLmdlbmVyYXRlUm91dGVzKHJlcy5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGdldFJvbGVzOiBmdW5jdGlvbiBnZXRSb2xlcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX2dldFJvbGVzKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX3RoaXMyLnJvbGVzTGlzdCA9IHJlcy5kYXRhOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBSZXNoYXBlIHRoZSByb3V0ZXMgc3RydWN0dXJlIHNvIHRoYXQgaXQgbG9va3MgdGhlIHNhbWUgYXMgdGhlIHNpZGViYXIKICAgIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhyb3V0ZXMpIHsKICAgICAgdmFyIGJhc2VQYXRoID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnLyc7CiAgICAgIHZhciByZXMgPSBbXTsKCiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyb3V0ZXMpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcm91dGUgPSBfc3RlcC52YWx1ZTsKCiAgICAgICAgICAvLyBza2lwIHNvbWUgcm91dGUKICAgICAgICAgIGlmIChyb3V0ZS5oaWRkZW4pIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG9ubHlPbmVTaG93aW5nQ2hpbGQgPSB0aGlzLm9ubHlPbmVTaG93aW5nQ2hpbGQocm91dGUuY2hpbGRyZW4sIHJvdXRlKTsKCiAgICAgICAgICBpZiAocm91dGUuY2hpbGRyZW4gJiYgb25seU9uZVNob3dpbmdDaGlsZCAmJiAhcm91dGUuYWx3YXlzU2hvdykgewogICAgICAgICAgICByb3V0ZSA9IG9ubHlPbmVTaG93aW5nQ2hpbGQ7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICAgIHBhdGg6IHBhdGgucmVzb2x2ZShiYXNlUGF0aCwgcm91dGUucGF0aCksCiAgICAgICAgICAgIHRpdGxlOiByb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEudGl0bGUKICAgICAgICAgIH07IC8vIHJlY3Vyc2l2ZSBjaGlsZCByb3V0ZXMKCiAgICAgICAgICBpZiAocm91dGUuY2hpbGRyZW4pIHsKICAgICAgICAgICAgZGF0YS5jaGlsZHJlbiA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGUuY2hpbGRyZW4sIGRhdGEucGF0aCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmVzLnB1c2goZGF0YSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXM7CiAgICB9LAogICAgZ2VuZXJhdGVBcnI6IGZ1bmN0aW9uIGdlbmVyYXRlQXJyKHJvdXRlcykgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBkYXRhID0gW107CiAgICAgIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgICAgIGRhdGEucHVzaChyb3V0ZSk7CgogICAgICAgIGlmIChyb3V0ZS5jaGlsZHJlbikgewogICAgICAgICAgdmFyIHRlbXAgPSBfdGhpczMuZ2VuZXJhdGVBcnIocm91dGUuY2hpbGRyZW4pOwoKICAgICAgICAgIGlmICh0ZW1wLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZGF0YSA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZGF0YSksIF90b0NvbnN1bWFibGVBcnJheSh0ZW1wKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9LAogICAgaGFuZGxlQWRkUm9sZTogZnVuY3Rpb24gaGFuZGxlQWRkUm9sZSgpIHsKICAgICAgdGhpcy5yb2xlID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFJvbGUpOwoKICAgICAgaWYgKHRoaXMuJHJlZnMudHJlZSkgewogICAgICAgIHRoaXMuJHJlZnMudHJlZS5zZXRDaGVja2VkTm9kZXMoW10pOwogICAgICB9CgogICAgICB0aGlzLmRpYWxvZ1R5cGUgPSAnbmV3JzsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICBoYW5kbGVFZGl0OiBmdW5jdGlvbiBoYW5kbGVFZGl0KHNjb3BlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5kaWFsb2dUeXBlID0gJ2VkaXQnOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgICB0aGlzLmNoZWNrU3RyaWN0bHkgPSB0cnVlOwogICAgICB0aGlzLnJvbGUgPSBkZWVwQ2xvbmUoc2NvcGUucm93KTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHZhciByb3V0ZXMgPSBfdGhpczQuZ2VuZXJhdGVSb3V0ZXMoX3RoaXM0LnJvbGUucm91dGVzKTsKCiAgICAgICAgX3RoaXM0LiRyZWZzLnRyZWUuc2V0Q2hlY2tlZE5vZGVzKF90aGlzNC5nZW5lcmF0ZUFycihyb3V0ZXMpKTsgLy8gc2V0IGNoZWNrZWQgc3RhdGUgb2YgYSBub2RlIG5vdCBhZmZlY3RzIGl0cyBmYXRoZXIgYW5kIGNoaWxkIG5vZGVzCgoKICAgICAgICBfdGhpczQuY2hlY2tTdHJpY3RseSA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVEZWxldGU6IGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShfcmVmKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdmFyICRpbmRleCA9IF9yZWYuJGluZGV4LAogICAgICAgICAgcm93ID0gX3JlZi5yb3c7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ0NvbmZpcm0gdG8gcmVtb3ZlIHRoZSByb2xlPycsICdXYXJuaW5nJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAnQ29uZmlybScsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ0NhbmNlbCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gZGVsZXRlUm9sZShyb3cua2V5KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX3RoaXM1LnJvbGVzTGlzdC5zcGxpY2UoJGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgICBfdGhpczUuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdEZWxldGUgc3VjY2VkIScKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkpLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICAgIH0pOwogICAgfSwKICAgIGdlbmVyYXRlVHJlZTogZnVuY3Rpb24gZ2VuZXJhdGVUcmVlKHJvdXRlcykgewogICAgICB2YXIgYmFzZVBhdGggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcvJzsKICAgICAgdmFyIGNoZWNrZWRLZXlzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHZhciByZXMgPSBbXTsKCiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocm91dGVzKSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByb3V0ZSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgIHZhciByb3V0ZVBhdGggPSBwYXRoLnJlc29sdmUoYmFzZVBhdGgsIHJvdXRlLnBhdGgpOyAvLyByZWN1cnNpdmUgY2hpbGQgcm91dGVzCgogICAgICAgICAgaWYgKHJvdXRlLmNoaWxkcmVuKSB7CiAgICAgICAgICAgIHJvdXRlLmNoaWxkcmVuID0gdGhpcy5nZW5lcmF0ZVRyZWUocm91dGUuY2hpbGRyZW4sIHJvdXRlUGF0aCwgY2hlY2tlZEtleXMpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjaGVja2VkS2V5cy5pbmNsdWRlcyhyb3V0ZVBhdGgpIHx8IHJvdXRlLmNoaWxkcmVuICYmIHJvdXRlLmNoaWxkcmVuLmxlbmd0aCA+PSAxKSB7CiAgICAgICAgICAgIHJlcy5wdXNoKHJvdXRlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzOwogICAgfSwKICAgIGNvbmZpcm1Sb2xlOiBmdW5jdGlvbiBjb25maXJtUm9sZSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgaXNFZGl0LCBjaGVja2VkS2V5cywgaW5kZXgsIF95aWVsZCRhZGRSb2xlLCBkYXRhLCBfdGhpczYkcm9sZSwgZGVzY3JpcHRpb24sIGtleSwgbmFtZTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlzRWRpdCA9IF90aGlzNi5kaWFsb2dUeXBlID09PSAnZWRpdCc7CiAgICAgICAgICAgICAgICBjaGVja2VkS2V5cyA9IF90aGlzNi4kcmVmcy50cmVlLmdldENoZWNrZWRLZXlzKCk7CiAgICAgICAgICAgICAgICBfdGhpczYucm9sZS5yb3V0ZXMgPSBfdGhpczYuZ2VuZXJhdGVUcmVlKGRlZXBDbG9uZShfdGhpczYuc2VydmljZVJvdXRlcyksICcvJywgY2hlY2tlZEtleXMpOwoKICAgICAgICAgICAgICAgIGlmICghaXNFZGl0KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVSb2xlKF90aGlzNi5yb2xlLmtleSwgX3RoaXM2LnJvbGUpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpbmRleCA9IDA7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmICghKGluZGV4IDwgX3RoaXM2LnJvbGVzTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzNi5yb2xlc0xpc3RbaW5kZXhdLmtleSA9PT0gX3RoaXM2LnJvbGUua2V5KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczYucm9sZXNMaXN0LnNwbGljZShpbmRleCwgMSwgT2JqZWN0LmFzc2lnbih7fSwgX3RoaXM2LnJvbGUpKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgiYnJlYWsiLCAxNCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDIyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgcmV0dXJuIGFkZFJvbGUoX3RoaXM2LnJvbGUpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX3lpZWxkJGFkZFJvbGUgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkYWRkUm9sZS5kYXRhOwogICAgICAgICAgICAgICAgX3RoaXM2LnJvbGUua2V5ID0gZGF0YS5rZXk7CgogICAgICAgICAgICAgICAgX3RoaXM2LnJvbGVzTGlzdC5wdXNoKF90aGlzNi5yb2xlKTsKCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgIF90aGlzNiRyb2xlID0gX3RoaXM2LnJvbGUsIGRlc2NyaXB0aW9uID0gX3RoaXM2JHJvbGUuZGVzY3JpcHRpb24sIGtleSA9IF90aGlzNiRyb2xlLmtleSwgbmFtZSA9IF90aGlzNiRyb2xlLm5hbWU7CiAgICAgICAgICAgICAgICBfdGhpczYuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIF90aGlzNi4kbm90aWZ5KHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICdTdWNjZXNzJywKICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiXG4gICAgICAgICAgICA8ZGl2PlJvbGUgS2V5OiAiLmNvbmNhdChrZXksICI8L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+Um9sZSBOYW1lOiAiKS5jb25jYXQobmFtZSwgIjwvZGl2PlxuICAgICAgICAgICAgPGRpdj5EZXNjcmlwdGlvbjogIikuY29uY2F0KGRlc2NyaXB0aW9uLCAiPC9kaXY+XG4gICAgICAgICAgIiksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyByZWZlcmVuY2U6IHNyYy92aWV3L2xheW91dC9jb21wb25lbnRzL1NpZGViYXIvU2lkZWJhckl0ZW0udnVlCiAgICBvbmx5T25lU2hvd2luZ0NoaWxkOiBmdW5jdGlvbiBvbmx5T25lU2hvd2luZ0NoaWxkKCkgewogICAgICB2YXIgY2hpbGRyZW4gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgICB2YXIgcGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBvbmx5T25lQ2hpbGQgPSBudWxsOwogICAgICB2YXIgc2hvd2luZ0NoaWxkcmVuID0gY2hpbGRyZW4uZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuICFpdGVtLmhpZGRlbjsKICAgICAgfSk7IC8vIFdoZW4gdGhlcmUgaXMgb25seSBvbmUgY2hpbGQgcm91dGUsIHRoZSBjaGlsZCByb3V0ZSBpcyBkaXNwbGF5ZWQgYnkgZGVmYXVsdAoKICAgICAgaWYgKHNob3dpbmdDaGlsZHJlbi5sZW5ndGggPT09IDEpIHsKICAgICAgICBvbmx5T25lQ2hpbGQgPSBzaG93aW5nQ2hpbGRyZW5bMF07CiAgICAgICAgb25seU9uZUNoaWxkLnBhdGggPSBwYXRoLnJlc29sdmUocGFyZW50LnBhdGgsIG9ubHlPbmVDaGlsZC5wYXRoKTsKICAgICAgICByZXR1cm4gb25seU9uZUNoaWxkOwogICAgICB9IC8vIFNob3cgcGFyZW50IGlmIHRoZXJlIGFyZSBubyBjaGlsZCByb3V0ZSB0byBkaXNwbGF5CgoKICAgICAgaWYgKHNob3dpbmdDaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgICBvbmx5T25lQ2hpbGQgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHBhcmVudCksIHt9LCB7CiAgICAgICAgICBwYXRoOiAnJywKICAgICAgICAgIG5vU2hvd2luZ0NoaWxkcmVuOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG9ubHlPbmVDaGlsZDsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"mappings":"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","names":["key","name","description","routes","data","role","rolesList","dialogVisible","dialogType","checkStrictly","defaultProps","children","label","computed","routesData","created","methods","getRoutes","res","getRoles","generateRoutes","route","path","title","generateArr","handleAddRole","handleEdit","scope","handleDelete","confirmButtonText","cancelButtonText","type","then","deleteRole","message","catch","console","generateTree","confirmRole","isEdit","checkedKeys","updateRole","index","addRole","dangerouslyUseHTMLString","onlyOneShowingChild","onlyOneChild","noShowingChildren"],"sourceRoot":"src/views/permission","sources":["role.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-button type=\"primary\" @click=\"handleAddRole\">New Role</el-button>\n\n    <el-table :data=\"rolesList\" style=\"width: 100%;margin-top:30px;\" border>\n      <el-table-column align=\"center\" label=\"Role Key\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.key }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" label=\"Role Name\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.name }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"Description\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.description }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" label=\"Operations\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(scope)\">Edit</el-button>\n          <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(scope)\">Delete</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog :visible.sync=\"dialogVisible\" :title=\"dialogType==='edit'?'Edit Role':'New Role'\">\n      <el-form :model=\"role\" label-width=\"80px\" label-position=\"left\">\n        <el-form-item label=\"Name\">\n          <el-input v-model=\"role.name\" placeholder=\"Role Name\" />\n        </el-form-item>\n        <el-form-item label=\"Desc\">\n          <el-input\n            v-model=\"role.description\"\n            :autosize=\"{ minRows: 2, maxRows: 4}\"\n            type=\"textarea\"\n            placeholder=\"Role Description\"\n          />\n        </el-form-item>\n        <el-form-item label=\"Menus\">\n          <el-tree\n            ref=\"tree\"\n            :check-strictly=\"checkStrictly\"\n            :data=\"routesData\"\n            :props=\"defaultProps\"\n            show-checkbox\n            node-key=\"path\"\n            class=\"permission-tree\"\n          />\n        </el-form-item>\n      </el-form>\n      <div style=\"text-align:right;\">\n        <el-button type=\"danger\" @click=\"dialogVisible=false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"confirmRole\">Confirm</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport path from 'path'\nimport { deepClone } from '@/utils'\nimport { getRoutes, getRoles, addRole, deleteRole, updateRole } from '@/api/role'\n\nconst defaultRole = {\n  key: '',\n  name: '',\n  description: '',\n  routes: []\n}\n\nexport default {\n  data() {\n    return {\n      role: Object.assign({}, defaultRole),\n      routes: [],\n      rolesList: [],\n      dialogVisible: false,\n      dialogType: 'new',\n      checkStrictly: false,\n      defaultProps: {\n        children: 'children',\n        label: 'title'\n      }\n    }\n  },\n  computed: {\n    routesData() {\n      return this.routes\n    }\n  },\n  created() {\n    // Mock: get all routes and roles list from server\n    this.getRoutes()\n    this.getRoles()\n  },\n  methods: {\n    async getRoutes() {\n      const res = await getRoutes()\n      this.serviceRoutes = res.data\n      this.routes = this.generateRoutes(res.data)\n    },\n    async getRoles() {\n      const res = await getRoles()\n      this.rolesList = res.data\n    },\n\n    // Reshape the routes structure so that it looks the same as the sidebar\n    generateRoutes(routes, basePath = '/') {\n      const res = []\n\n      for (let route of routes) {\n        // skip some route\n        if (route.hidden) { continue }\n\n        const onlyOneShowingChild = this.onlyOneShowingChild(route.children, route)\n\n        if (route.children && onlyOneShowingChild && !route.alwaysShow) {\n          route = onlyOneShowingChild\n        }\n\n        const data = {\n          path: path.resolve(basePath, route.path),\n          title: route.meta && route.meta.title\n\n        }\n\n        // recursive child routes\n        if (route.children) {\n          data.children = this.generateRoutes(route.children, data.path)\n        }\n        res.push(data)\n      }\n      return res\n    },\n    generateArr(routes) {\n      let data = []\n      routes.forEach(route => {\n        data.push(route)\n        if (route.children) {\n          const temp = this.generateArr(route.children)\n          if (temp.length > 0) {\n            data = [...data, ...temp]\n          }\n        }\n      })\n      return data\n    },\n    handleAddRole() {\n      this.role = Object.assign({}, defaultRole)\n      if (this.$refs.tree) {\n        this.$refs.tree.setCheckedNodes([])\n      }\n      this.dialogType = 'new'\n      this.dialogVisible = true\n    },\n    handleEdit(scope) {\n      this.dialogType = 'edit'\n      this.dialogVisible = true\n      this.checkStrictly = true\n      this.role = deepClone(scope.row)\n      this.$nextTick(() => {\n        const routes = this.generateRoutes(this.role.routes)\n        this.$refs.tree.setCheckedNodes(this.generateArr(routes))\n        // set checked state of a node not affects its father and child nodes\n        this.checkStrictly = false\n      })\n    },\n    handleDelete({ $index, row }) {\n      this.$confirm('Confirm to remove the role?', 'Warning', {\n        confirmButtonText: 'Confirm',\n        cancelButtonText: 'Cancel',\n        type: 'warning'\n      })\n        .then(async() => {\n          await deleteRole(row.key)\n          this.rolesList.splice($index, 1)\n          this.$message({\n            type: 'success',\n            message: 'Delete succed!'\n          })\n        })\n        .catch(err => { console.error(err) })\n    },\n    generateTree(routes, basePath = '/', checkedKeys) {\n      const res = []\n\n      for (const route of routes) {\n        const routePath = path.resolve(basePath, route.path)\n\n        // recursive child routes\n        if (route.children) {\n          route.children = this.generateTree(route.children, routePath, checkedKeys)\n        }\n\n        if (checkedKeys.includes(routePath) || (route.children && route.children.length >= 1)) {\n          res.push(route)\n        }\n      }\n      return res\n    },\n    async confirmRole() {\n      const isEdit = this.dialogType === 'edit'\n\n      const checkedKeys = this.$refs.tree.getCheckedKeys()\n      this.role.routes = this.generateTree(deepClone(this.serviceRoutes), '/', checkedKeys)\n\n      if (isEdit) {\n        await updateRole(this.role.key, this.role)\n        for (let index = 0; index < this.rolesList.length; index++) {\n          if (this.rolesList[index].key === this.role.key) {\n            this.rolesList.splice(index, 1, Object.assign({}, this.role))\n            break\n          }\n        }\n      } else {\n        const { data } = await addRole(this.role)\n        this.role.key = data.key\n        this.rolesList.push(this.role)\n      }\n\n      const { description, key, name } = this.role\n      this.dialogVisible = false\n      this.$notify({\n        title: 'Success',\n        dangerouslyUseHTMLString: true,\n        message: `\n            <div>Role Key: ${key}</div>\n            <div>Role Name: ${name}</div>\n            <div>Description: ${description}</div>\n          `,\n        type: 'success'\n      })\n    },\n    // reference: src/view/layout/components/Sidebar/SidebarItem.vue\n    onlyOneShowingChild(children = [], parent) {\n      let onlyOneChild = null\n      const showingChildren = children.filter(item => !item.hidden)\n\n      // When there is only one child route, the child route is displayed by default\n      if (showingChildren.length === 1) {\n        onlyOneChild = showingChildren[0]\n        onlyOneChild.path = path.resolve(parent.path, onlyOneChild.path)\n        return onlyOneChild\n      }\n\n      // Show parent if there are no child route to display\n      if (showingChildren.length === 0) {\n        onlyOneChild = { ... parent, path: '', noShowingChildren: true }\n        return onlyOneChild\n      }\n\n      return false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.app-container {\n  .roles-table {\n    margin-top: 30px;\n  }\n  .permission-tree {\n    margin-bottom: 30px;\n  }\n}\n</style>\n"]}]}